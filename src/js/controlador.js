///-----------------------------------------------USUARIOS
var usuarios = [{
        nombre: "Pedro",
        apellido: "Martinez",
        ordenes: [{
                nombreProducto: "Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            },
            {
                nombreProducto: "Producto 2",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            }
        ]
    },
    {
        nombre: "Juan",
        apellido: "Perez",
        ordenes: [{
                nombreProducto: "Producto 3",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            },
            {
                nombreProducto: "Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            }
        ]
    },
    {
        nombre: "Maria",
        apellido: "Rodriguez",
        ordenes: [{
                nombreProducto: "Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            },
            {
                nombreProducto: "Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            }
        ]
    }
];


///-----------------------------------------------CATEGORIAS
var categorias = [{
        nombreCategoria: "Farmacias",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#C4BA82",
        icono: "fab fa-angellist",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Restaurantes",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#82C4A9",
        icono: "fab fa-angellist",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Salud",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#9482C4",
        icono: "fab fa-angellist",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Café",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#3B1F88",
        icono: "fab fa-angellist",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Bebidas",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#C482B9",
        icono: "fab fa-angellist",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    }
];


console.log('Usuarios', usuarios);
console.log('Categorias', categorias);

almacenarCat();
cargarCategorias();
cargarUser();
cambiarUsuario();

function addCat() {

    const categoria = {
        nombreCategoria: document.getElementById('nombreCat').value,
        descripcion: document.getElementById('descripcionCat').value,
        color: document.getElementById('colorCat').value,
        icono: document.getElementById('iconoCat').value,
        empresas: []
    }

    if (categoria.nombreCategoria && categoria.descripcion && categoria.color && categoria.icono != '') {
        categorias.push(categoria);
        localStorage.setItem('categorias', JSON.stringify(categorias));

        cargarCategorias()
        alert('Categoria agregada exitosamente')
        $('#addCat').modal('hide')
    } else {
        alert('Faltan Campos')
    }

}

function procesarOrden(name, desc, price) {
    let userSelect = $('#usuarioActual').val();
    usuarios.forEach(usuario => {
        if (usuario.nombre == userSelect) {
            alert('Orden Agregada')
            const orden = {
                cantidad: document.getElementById('cantidad').value,
                descripcion: desc,
                nombreProducto: name,
                precio: price,
            }
            usuario.ordenes.push(orden);
            localStorage.setItem('usuarios', JSON.stringify(usuarios))
        }
    });

    cambiarUsuario();
    $('#modalPedir').modal('hide')
    $('#verEmpresas').modal('hide')
}

function newOrden(name, desc, price) {
    document.getElementById('modalOrden').innerHTML = ''
    document.getElementById('modalOrden').innerHTML += `<div class="modal-content" style="width: 70%;
    margin: auto;
    margin-top: 10rem; border-radius: 1.2rem;">

        <div class="modal-body" style="padding-bottom: 0px;">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div id="pedido">


                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer" style="border-top:1px solid transparent; padding-top: 0px;">
            <button type="button" class="btn btn-primary" style="background-color: #500870!important;
            border-color: transparent;
            border-radius: 2rem;
            width: 9rem;
            padding: 2px;" onclick="procesarOrden('${name}','${desc}','${price}')">Procesar Orden</button>
        </div>
    </div>`


    document.getElementById('pedido').innerHTML += `<h5 class="card-title" id="nameProduct" style="font-size: 130%; font-weight: 500;">${name}</h5>

    <h6 class="card-subtitle mb-2 text-muted fonts2" id="descProduct" style="font-weight: bolder; font-size: 90%;">${desc}</h6>
    <br>
    <div class="row">
        <h6 class="col-6 fonts2" id="descProduct" style="font-weight: bolder; font-size: 90%; margin-top: 0.5rem;">Cantidad a solicitar:</h6>
        <input type="number" id="cantidad" class="col-6" style="border-radius: .7rem;
        border-width: thin;">
    </div>
    <br>
    <h6 class="card-subtitle mb-2 text-muted" id="price">$${price}</h6>`
}

function empresas(name) {

    let productos = ''
    document.getElementById('tituloCat').innerHTML = ''

    categorias.forEach(categoria => {
        if (categoria.nombreCategoria == name) {
            document.getElementById('tituloCat').innerHTML += `<label class="navbar-brand col-12 fonts" href="#" style="    font-size: x-large; font-size: 120%;">${name}</label>`



            categoria.empresas.forEach(empresa => {
                productos = ''

                empresa.productos.forEach(producto => {
                    productos += `<div><div class="row">
                    <h5 class="card-title col-7" id="nameProduct" style="font-size: 100%; margin-bottom: 0px; font-weight: bold;">${producto.nombreProducto}</h5>
                    <button type="button" class="btn btn-primary col-5" data-toggle="modal" data-target="#modalPedir" style="background-color: #500870!important;border-color: transparent; padding: 0px;border-radius: 1rem;" onclick="newOrden('${producto.nombreProducto}','${producto.descripcion}','${producto.precio}')">Pedir</button>
                    </div><br><h6 class="card-subtitle mb-2 text-muted fonts2" id="descProduct" style="color:#343a40!important">${producto.descripcion}
                    </h6><br><h6 class="card-subtitle mb-2 text-muted" id="price">$${producto.precio}</h6></div>`
                });

                document.getElementById('empresas').innerHTML += `<div class="card" style="width: 18rem; border-radius: 2rem;
                margin: 0.4rem;
               border: 1px solid hsl(0deg 0% 13% / 22%);background-color: transparent;">
                    <div class="contenedor">
                        <img class="card-img-top" src="${empresa.imagen}" alt="Card image cap" style="    border-radius: 20px 20px 0 0;">
            
                        <div class="spanEmpresa fonts" style="color: aliceblue;
                   font-size: x-large;">${empresa.nombreEmpresa}</div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="card-body">
                                
                                ${productos}
            
                            </div>
            
            
                        </div>
            
                    </div>
                </div>`

            });
        }
    });




}


function cambiarUsuario() {
    let userSelect = $('#usuarioActual').val();


    document.getElementById('content').innerHTML = '';
    document.getElementById('botonOrden').innerHTML = '';

    document.getElementById('content').innerHTML += `
    <label for="" class="fonts starter-template" style="padding-bottom: 0px; margin-left:0.8rem">¡Hola ${userSelect}!</label><br>
    `

    document.getElementById('botonOrden').innerHTML += `<button class="btn btn-secondary my-2 my-sm-0 ver " type="submit" id="ver" style="height: 50px;
    margin-left: 15px;width: 250px; " data-toggle="modal" data-target="#verordenes" onclick="ordenes('${userSelect}')">Ver Ordenes</button>
    
    `
}

function cargarCategorias() {
    document.getElementById('cats').innerHTML = ''

    for (let i = 0; i < categorias.length; i++) {
        document.getElementById('cats').innerHTML += `<div class="col-lg-3 col-md-4 col-sm-6 divEmp" style="width: 100%;" data-toggle="modal" data-target="#verEmpresas" onclick="empresas('${categorias[i].nombreCategoria}')">
        <div class="card-body" style="padding: 1rem;background-color: ${categorias[i].color};
        border-radius: 2rem;margin-bottom: 1rem;">
            <div class="icon ${categorias[i].icono}"></div>
            <h5 class="card-title fonts" style="margin-top: 15%;color: white;font-size: 100%;">${categorias[i].nombreCategoria}</h5>
            <h6 class="card-subtitle mb-2 text-muted fonts2" style="color: white!important;font-size: 100%;margin-bottom: 0px!important;">${categorias[i].empresas.length} comercios</h6>

        </div>
    </div>`
    }
}

function cargarUser() {
    almacenarUser();
    for (let i = 0; i < usuarios.length; i++) {
        document.getElementById('usuarioActual').innerHTML += `<option value="${usuarios[i].nombre}">${usuarios[i].nombre} ${usuarios[i].apellido}</option>`
    }

}

function ordenes(name) {
    document.getElementById('OrdenesProduct').innerHTML = '';
    document.getElementById('saludo').innerHTML = '';

    document.getElementById('saludo').innerHTML += `<label class="navbar-brand col-12 fonts" href="#" style="font-size: x-large; font-size: 120%;">${name}, estas son tus órdenes</label>`




    usuarios.forEach(element => {
        if (element.nombre == name) {
            element.ordenes.forEach(products => {
                document.getElementById('OrdenesProduct').innerHTML += `<div>
                <h5 class="card-title" id="nameProduct">${products.nombreProducto}</h5>
                <h6 class="card-subtitle mb-2 text-muted fonts2" id="descProduct">${products.descripcion}</h6>
                <h6 class="card-subtitle mb-2 text-muted" id="price">$${products.precio}</h6>
            </div>`
            });
        }

    });

}

function almacenarCat() {
    if (localStorage.getItem('categorias') == null) {
        localStorage.setItem('categorias', JSON.stringify(categorias));

    } else {
        categorias = JSON.parse(localStorage.getItem('categorias'));

    }
}


function almacenarUser() {
    if (localStorage.getItem('usuarios') == null) {
        localStorage.setItem('usuarios', JSON.stringify(usuarios));

    } else {
        usuarios = JSON.parse(localStorage.getItem('usuarios'));

    }
}